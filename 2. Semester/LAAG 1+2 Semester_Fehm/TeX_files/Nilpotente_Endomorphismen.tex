\section{Nilpotente Endomorphismen}

\begin{remark}
	Für $f\in\End_K(V)$ sind 
	\begin{itemize}
		\item $f\{0\}=\Ker(f^0)\subseteq \Ker(f^1)\subseteq \Ker(f^2)\subseteq ...$
		\item $V=\Image(f^0)\supseteq \Image(f^1)\supseteq \Image(f^2)\supseteq ...$
	\end{itemize}
Folgen von Untervektorräumen von $V$. Nach der Kern-Bild-Formel \propref{3_7_13}III.7.13 ist
\begin{align}
	\dim_K(\Ker(f^i))+\dim_K(\Image(f^i))=\dim_K(V)\quad\forall i\notag
\end{align}
Da $\dim_K(V)=n<\infty$ gibt es ein $d$ mit $\Ker(f^d)=\Ker(f^{d+i})$ und $\Image(f^d)=\Image(f^{d+i})$ für jedes $i\ge 0$.
\end{remark}

\begin{example}
	$f=f_A$, $A\in\Mat_2(K)$.
	\begin{itemize}
		\item $A=\begin{henrysmatrix}1&0\\0&1\end{henrysmatrix}$: $\{0\}=\Ker(f^0)=\Ker(f^1)=...$
		\item $A=\begin{henrysmatrix}1&0\\0&0\end{henrysmatrix}$: $\{0\}=\Ker(f^0)\subset\Ker(f^1)\subsetneq\Ker(f^2)=...=\Span_K(e_2)$
		\item $A=\begin{henrysmatrix}0&1\\0&0\end{henrysmatrix}$: $\{0\}=\Ker(f^0)\subset\underbrace{\Ker(f^1)}_{=\Span_K(e_1)}\subset \Ker(f^2)=... = K^2$
		\item $A=\begin{henrysmatrix}0&0\\0&0\end{henrysmatrix}$: $\{0\}=\Ker(f^0)\subset\Ker(f^1)=\Ker(f^2)=...=K^2$
	\end{itemize}
\end{example}

\begin{lemma}
	\proplbl{lemma_6_3}
	Seien $f,g\in\End_K(V)$. Wenn $f$ und  $g$ kommutieren, d.h. $f\circ g=g\circ f$, so sind die Untervektorräume $\Ker(g)$ und $\Image(g)$ $f$ invariant.
\end{lemma}
\begin{proof}
	Ist $x\in\Ker(f)$, so ist $g(f(x))=f(g(x))=f(0)=0$, also $f(x)\in\Ker(g)$. Für $g(x)\in\Image(g)$ ist $f(g(x))=g(f(x))\in\Image(g)$.
\end{proof}

\begin{proposition}[Lemma von \person{Fitting}]
	\proplbl{satz_6_4}
	Seien $V_i=\Ker(f^i)$, $W_i=\Image(f^i)$, $d=\min\{i\mid V_i=V_{i+1}\}$. Dann sind 
	\begin{align}
		\{0\}&=V_0\subsetneq V_1\subsetneq ...\subsetneq V_d=V_{d+1}=...\notag \\
		V&= W_0\supsetneq W_1\supsetneq ... \supsetneq W_d=W_{d+1}=...\notag
	\end{align}
	Folgen $f$-invarianter Untervektorräume und $V=V_d\oplus W_d$.
\end{proposition}
\begin{proof}
	Da $f^i$ und $f^j$ für beliebige $i,j$ kommutieren, sind $V_i$ und $V_j$ nach \propref{lemma_6_3} $f$-invariant für jedes $i$. Aus $\dim_K(V_i)+\dim_K(W_i)=n$ folgt $d=\min\{i\mid W_i=W_{i+1}\}$, insbesondere ist $\Image(f^d)=\Image(f^{d+1})=f(\Image(f^d))$, somit $W_{d+i}=\Image(f^{d+i})=W_d$ für $i\ge 0$, also auch $V_d=V_{d+i}$ für alle $i\ge 0$. \\
	Insbesondere ist $f^d\vert_{W_d}:W_d\to W_{2d}=W_d$ surjektiv, also auch injektiv, also $V_d\cap W_d=\{0\}$. Aus der Dimensionsformel II.4.12 folgt dann $\dim_K(V_d+W_d)=\dim_K(V_d)+\dim_K(W_d)=\dim_K(V)$. Folglich ist $V_d+W_d=V$ und $V_d\cap W_d=\{0\}$, also $V=V_d\oplus W_d$.
\end{proof}

\begin{definition}[nilpotent]
	Ein $f\in\End_K(V)$ heißt \begriff{nilpotent}, wenn $f^k=0$ für ein $k\in\natur$. Analog heißt $A\in\Mat_n(K)$ nilpotent, wenn $A^k=0$ für $k\in\natur$. Das kleinste $k$ mit $f^k=0$ bzw. $A^k$ heißt die \begriff{Nilpotenzklasse} von $f$ bzw. $A$.
\end{definition}

\begin{lemma}
	\proplbl{lemma_6_6}
	Ist $f$ nilpotent, so gibt es eine Basis $B$ von $V$, für die $M_B(f)$ eine strikte obere Dreiecksmatrix ist.
\end{lemma}
\begin{proof}
	Induktion nach $n=\dim_K(V)$. \\
	\emph{$n=1$}: $f^k=0\Rightarrow f=0$ \\
	\emph{$n>1$}: Sei $k$ die Nilpotenzklasse von $f$ und $U=\Ker(f^{k-1})$. Dann ist $U\subset V$. Da $f^k=f^{k-1}\circ f$ ist $f(V)\subset U$, insbesondere $f\vert_U\in\End_K(U)$. Da $f\vert_U$ nilpotent ist, gibt es nach I.H. eine Basis $B_0$ von $U$, für die $M_B(f\vert_U)$ eine strikte obere Dreiecksmatrix ist. Ergänze $B_0$ zu einer Basis $B$ von $V$. Da $f(V)\subset U$ ist dann auch 
	\begin{align}
		M_B(f)=\begin{pmatrix}M_{B_0}(f\vert_U)&*\\0&0\end{pmatrix}\notag
	\end{align}
	eine strikte obere Dreiecksmatrix.
\end{proof}

\begin{proposition}
	\proplbl{satz_6_7}
	Für $f\in\End_K(V)$ sind äquivalent:
	\begin{enumerate}[label={\arabic*)}]
		\item $f$ ist nilpotent
		\item $f^n=0$ für $n \in \natur$
		\item $P_f(t)=t^r$ für ein $r\leq n$
		\item $\chi_f(t)=t^n$
		\item Es gibt eine Basis $B$ von $V$, mit 
		\[
		M_B(f) = 
		\begin{pmatrix}
		0 & \textasteriskcentered & \dots & \textasteriskcentered\\
		& \ddots & \ddots & \vdots \\
		& & \ddots & \textasteriskcentered \\
		& & & 0
		\end{pmatrix}
		\] eine strikte obere Dreiecksmatrix ist.
	\end{enumerate}
\end{proposition}
\begin{proof}
	\hspace{0pt}
	\begin{itemize}
		\item $1)\Rightarrow 5)$: \propref{lemma_6_6}
		\item $5)\Rightarrow 4)$: \propref{beispiel_2_8}
		\item $4)\Rightarrow 3)$: Nach \propref{folgerung_5_10} ist $P_f\mid \chi_f=t^n$, also $t^n=P_f(t)Q(t)$ mit $Q\in K[t]$. Schreibe $P_f(t)=t^a\cdot P_1(t), Q(t)=t^b\cdot Q_1(t)$ mit $a,b\in\natur$, $P_1,Q_1\in K[t]$, $P_1(0)\neq 0$, $Q_1(0)\neq 0$ \\
		$\overset{\propref{lemma_3_8}}{\Rightarrow} t^{n-(a+b)}=P_1(t)Q_1(t)$ und $(P_1Q_1)(0)\neq 0$ \\
		$\Rightarrow n-(a+b)=0\Rightarrow P_1=1$, somit $P_f(t)=t^a$
		\item $3)\Rightarrow 2)$: $t^r=0$, $r\leq n\Rightarrow f^n=0$
		\item $2)\Rightarrow 1)$: nach Definition
	\end{itemize}
\end{proof}

\begin{conclusion}
	Die Nilpotenzklasse eines nilpotenten Endomorphismus $f\in\End_K(V)$ ist höchstens $\dim_K(V)$.
\end{conclusion}

\begin{conclusion}
	\proplbl{folgerung_6_9}
	Ist $d:=\min\{i\mid \Ker(f^i)=\Ker(f^{i+1})\}$, so ist $d\le \dim_K(\Ker(f))=\mu_a(f,0)$.
\end{conclusion}
\begin{proof}
	Sei $V_d=\Ker(f^d)$, $W_d=\Image(f^d)$, $k=\dim_K(V_d)$. Da $V=V_d\oplus W_d$ ist $\chi_f=\chi_{f\vert_{V_d}}\cdot \chi_{f\vert_{W_d}}$. Da $f\vert_{V_d}$ nilpotent ist, ist $\chi_{f\vert_{V_d}}=t$ nach \propref{satz_6_7}. Da $f\vert_{W_d}$ injektiv ist, ist $\chi_{f\vert_{W_d}}(0)\neq 0$. Somit ist $\mu_a(f,0)= \mu(\chi_f,0) \overset{\propref{lemma_3_6}}{=}k$. Da $\dim_K(\Ker(f^d))>...>\dim_K(\Ker(f))>0$ ist $k=\dim_K(\Ker(f^d))\ge d$, falls $d>0$, sonst klar. 
\end{proof}

\begin{remark}
	Die Bedeutung nilpotenter Endomorphismen beim Finden geeigneter Basen ergibt sich aus der folgenden Beobachtung: \\
	Ist $A$ eine obere Dreiecksmatrix, so ist $A=D+N$, wobei $D$ eine Diagonalmatrix ist und $N$ eine strikte obere Dreiecksmatrix ist. Anders gesagt: Jeder trigonalisierbare Endomorphismus ist Summe aus einem diagonalisierbaren und einem nilpotenten Endomorphismus.
\end{remark}

\begin{definition}[\person{Jordan}-Matrix]
	Für $k\in\natur$ definieren wir die \begriff{\person{Jordan}-Matrix}
	\begin{align}
		J_k=\begin{pmatrix}0&1&0&...&0 \\
		\vdots&\ddots&\ddots&\ddots&\vdots\\
		\vdots&\;&\ddots&\ddots&0\\
		\vdots&\;&\;&\ddots&1\\
		0&...&...&...&0\end{pmatrix} \in \Mat_k(K)\notag
	\end{align}
	weiter setzen wir für $\lambda\in K$ $J_k(\lambda):=\lambda\mathbbm{1}+J_k$.
\end{definition}

\begin{lemma}
	\proplbl{lemma_6_12}
	Die \person{Jordan}-Matrix $J_k$ ist nilpotent von Nilpotenzklasse $k$.
\end{lemma}
\begin{proof}
	Es ist $(J_k)^r=(\delta_{i+r,j})_{i,j}$ für $r\ge 1$.
\end{proof}

\begin{proposition}
	\proplbl{satz_6_13}
	Ist $f$ nilpotent von Nilpotenzklasse $k$, so gibt es eindeutig bestimmte $r_1,..,r_k\in\natur_{>0}$ mit $\sum\limits_{d=1}^k dr_d=n$ und eine Basis $B$ von $V$ mit 
	\begin{align}
		M_B(f)=\diag(\underbrace{J_k,...,J_k}_{r_k\text{ viele}},...,\underbrace{J_1,...,J_1}_{r_1\text{ viele}})\notag
	\end{align}
\end{proposition}
\begin{proof}
	Sei $U_i=\Ker(f^i)$. Nach \propref{satz_6_4} haben wir eine Folge $\{0\}=U_0\subset U_1\subset ...\subset U_k=V$ mit $f(U_i)\subseteq U_{i-1}$ für alle $i>0$. \\
	Wir konstruieren eine Zerlegung $V=\bigoplus\limits_{d=1}^k W_d$ mit $U_i=U_{i-1}\oplus W_i$, $f(W_i)\subseteq W_{i-1}$, $f\vert_{W_d}$ injektiv für $i>1$.
	\begin{align}
		V&= U_k\notag \\
		V&= U_{k-1}\oplus W_k \notag \\
		V&= U_{k-2}\oplus W_{k-1}\oplus W_k \notag \\
		\vdots \notag \\
		V&= U_0 \oplus W_1\oplus ... \oplus W_k\notag
	\end{align}
	Wähle $W_k$ mit $V=U_k=U_{k-1}\oplus W_k$. Ist $k>1$, so ist $W_k\cap \Ker(f)\subseteq W_k\cap U_{k-1}=\{0\}$, also $f\vert_{W_k}$ ist injektiv. Des weiteren ist $f(W_k)\subseteq U_{k-1}$ und aus $W_k\cap U_{k-1}=\{0\}$ folgt $f(W_k)\cap U_{k-2}=\{0\}$. Wir können deshalb $W_{k-1}$ mit $U_{k-1}=U_{k-2}\oplus W_{k-1}$ und $f(W_k)\subseteq W_{k-1}$ wählen. Somit ist $V=U_{k-1}\oplus W_k=U_{k-2}\oplus W_{k-1}\oplus W_k$. Wir setzen dies fort und erhalten $V= U_0 \oplus W_1\oplus ... \oplus W_k$ mit $f(W_i)\subseteq W_{i-1}$ und $f\vert_{W_i}$ injektiv für $i>1$, wobei $U_0=\{0\}$ und $W_1=\Ker(f)$. \\
	Sie $r_d=\dim_K(W_d)-\dim_K(W_{d+1})$, wobei wir $W_{k+1}=\{0\}$. Wähle nun eine Basis $(x_{k,1},...,x_{k,r_k})$ von $W_k$. Ist $k>1$, so ist $f\vert_{W_k}$ injektiv und wir können $(f(x_{k,1}),...,f(x_{k,r_k}))$ durch Elemente $x_{k-1,1},...,x_{k-1,r_{k-1}}$ zu einer Basis von $W_{k-1}$ ergänzen, und so weiter.\\
	Da $V=\bigoplus\limits_{d=1}^k W_d$ ist
	\begin{align}
		B=\{f^i(x_{d,j})\mid d=1,...,k,j=1,...,r_d,i=0,...,d-1\}\notag
	\end{align}
	eine Basis von $V$, die bei geeigneter Anordnung das Gewünschte leistet. \\
	Es bleibt zu zeigen, dass $r_1,...,r_k$ eindeutig bestimmt sind. Ist $B_0$ eine Basis, für die $M_{B_0}(f)$ in der gewünschten Form ist, so ist 
	\begin{align}
		\dim_K(U_1) &= \sum\limits_{d=1}^k r_d \notag \\
		\dim_K(U_2) &= \sum\limits_{d=2}^k r_d + \sum\limits_{d=1}^k r_d \notag \\
		\vdots \notag \\
		\dim_K(U_k) &= \sum\limits_{d=k}^k r_d + ... + \sum\limits_{d=1}^k r_d\notag 
	\end{align}
	woraus man sieht, dass $r_1,...,r_k$ durch $U_1,...,U_k$, also durch $f$ eindeutig bestimmt.
\end{proof}

\begin{example}
	Sei $f=f_A$ mit $A=\begin{henrysmatrix}0&1&3\\\;&0&2\\\;&\;&0\end{henrysmatrix}\in\Mat_3(\real)$
	\begin{align}
		A^2=\begin{henrysmatrix}0&0&2\\\;&0&0\\\;&\;&0\end{henrysmatrix}, A^3=0\notag
	\end{align}
	$\Rightarrow k=3, U_0=\{0\}, U_1=\real e_1, U_2=\real e_1+\real e_2, U_3=V$. \\
	Wähle $W_3$ mit $V=U_3=U_2\oplus W_3$, z.B. $W_3=\real e_3$. \\
	Wähle $W_2$ mit $U_2=U_1\oplus W_2$ und $f(W_3)\subseteq W_2$, also 
	\begin{align}
		W_2=\real\begin{henrysmatrix}3\\2\\0\end{henrysmatrix}\notag
	\end{align}
	Setze $W_1=U_1=\Ker(f)=\real e_1\Rightarrow$ Basis $B=(f^2(e_3),f(e_3),e_3)$
	\begin{align}
		M_B(f)=\begin{henrysmatrix}0&1&0\; \\ \;&0&1\\ \;&\;&0\end{henrysmatrix}\notag
	\end{align}
\end{example}